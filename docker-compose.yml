services:
  dobrika-search:
    build:
      context: .
      dockerfile: Dockerfile
    image: dobrika-search:latest
    container_name: dobrika-search-server
    ports:
      - "8080:8080"
    volumes:
      # Persist Xapian database
      - ./db:/app/db
      # Persist uploads if any
      - ./uploads:/app/uploads
    environment:
      - DOBRIKA_ADDR=0.0.0.0
      - DOBRIKA_PORT=8080
      - DOBRIKA_DB_PATH=/app/db
      - DOBRIKA_COLD_MIN=30
      - DOBRIKA_HOT_MIN=15
      - DOBRIKA_SEARCH_OFFSET=0
      - DOBRIKA_SEARCH_LIMIT=20
      - DOBRIKA_GEO_INDEX=2
    restart: unless-stopped
    networks:
      - dobrika-network
    user: "1000:1000"

networks:
  dobrika-network:
    driver: bridge

